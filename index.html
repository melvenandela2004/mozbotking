<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Master Bot - Login e Dashboard</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<style>
*{box-sizing:border-box;}
body{
  font-family:'Segoe UI',sans-serif;
  margin:0;
  padding:0;
  background:linear-gradient(135deg,#667eea,#4a4a8a);
  display:flex;
  justify-content:center;
  align-items:flex-start;
  min-height:100vh;
  padding:20px;
}
.hidden{display:none;}
.box{
  background:#fff;
  padding:30px;
  border-radius:20px;
  box-shadow:0 15px 35px rgba(0,0,0,0.25);
  width:100%;
  max-width:400px;
  text-align:center;
  transition:0.5s opacity ease;
  opacity:1;
  margin-bottom:20px;
}
.box.fade-out{opacity:0;}

h1{
  margin-bottom:10px;
  color:#667eea;
  font-size:32px;
  font-weight:bold;
  text-shadow:1px 1px 5px rgba(0,0,0,0.2);
}
h2,h3{margin-bottom:15px;color:#333;}
h2.subtitle{font-size:16px;color:#eee;margin-bottom:25px;}

input, select{
  width:100%;
  max-width:95%;
  padding:12px;
  margin:10px 0;
  border-radius:10px;
  border:1px solid #ddd;
  transition:0.3s;
}
input:focus, select:focus{border-color:#667eea;outline:none;}

button{
  width:100%;
  max-width:95%;
  padding:12px;
  margin:10px 0;
  border:none;
  border-radius:12px;
  background:#667eea;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
  transition:0.3s;
}
button:hover{background:#5563c1; transform:translateY(-2px);}

a{color:#667eea;text-decoration:none;font-weight:bold;}
a:hover{text-decoration:underline;}

.popup{
  position:fixed;
  top:20px; right:20px;
  background:#667eea; color:#fff;
  padding:15px 20px;
  border-radius:10px;
  box-shadow:0 5px 15px rgba(0,0,0,0.2);
  opacity:0; transform:translateY(-20px);
  transition:0.5s;
  z-index:9999;
}
.popup.show{opacity:1; transform:translateY(0);}

/* Dashboard */
#painelBox{width:100%; max-width:700px;}
.dashboard-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;}
.user-list{display:flex;flex-direction:column;gap:10px;max-height:250px;overflow-y:auto;}
.user-card{display:flex;justify-content:space-between;align-items:center;background:#f9f9f9;padding:12px 15px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.1);transition:0.3s;}
.user-card:hover{background:#e6f0ff;}
.user-info{display:flex;align-items:center;gap:10px;}
.user-info i{font-size:20px;color:#667eea;}
.user-card span{font-weight:bold;color:#333;}
.user-card button{width:auto;padding:6px 12px;background:#ff4d4f;border-radius:8px;color:#fff;border:none;cursor:pointer;}
.user-card button:hover{background:#e63b3b;}

/* Página de Sinais */
#paginaSinais .sinais-box{
  background:#fff;
  padding:20px;
  border-radius:16px;
  box-shadow:0 5px 15px rgba(0,0,0,0.2);
  margin-top:20px;
}
#casas{width:100%; max-width:95%; padding:12px;border-radius:8px;border:1px solid #ddd;margin-bottom:10px;}
#quadradinhos{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(60px,1fr));
  gap:10px;
  margin-top:15px;
}
.quadrado{
  height:50px;
  background:#ff69b4;
  border-radius:10px;
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  font-weight:bold;
  cursor:pointer;
  transition:0.3s;
}
.quadrado:hover{background:#ff4da6;}
#protecao{margin-top:10px;font-weight:bold;color:#333;}

/* Responsividade Mobile e Tablet */
@media(max-width:768px){
  body{padding:15px;}
  .box{padding:20px;}
  h1{font-size:28px;}
  #painelBox{width:100%;}
  #quadradinhos{grid-template-columns:repeat(auto-fit,minmax(50px,1fr));}
}

@media(max-width:450px){
  h1{font-size:24px;}
  .box{padding:15px;}
  #quadradinhos{grid-template-columns:repeat(2,1fr);}
  input,select,button{width:100%;}
}
</style>
</head>
<body>

<!-- LOGIN -->
<div class="box" id="loginBox">
  <h1>Master Bot</h1>
  <h2 class="subtitle">Sua plataforma de sinais</h2>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="senha" placeholder="Senha">
  <button onclick="fazerLogin()">Entrar</button>
  <button onclick="mostrarPainelSenha()">Painel Admin</button>
  <p><a href="https://wa.me/852832276" target="_blank">Queres criar conta?</a></p>
</div>

<!-- SENHA ADMIN -->
<div class="box hidden" id="painelSenhaBox">
  <h2>Senha Mestra</h2>
  <input type="password" id="adminSenha" placeholder="Senha do administrador">
  <button onclick="entrarPainel()">Entrar</button>
</div>

<!-- DASHBOARD SAAS -->
<div class="box hidden" id="painelBox">
  <div class="dashboard-header">
    <h2>Dashboard SaaS</h2>
    <span>Total Usuários: <b id="totalUsers">0</b></span>
  </div>
  <button onclick="sairPainel()">Sair do Painel</button>

  <h3>Criar Conta</h3>
  <input type="text" id="numero" placeholder="Número">
  <input type="email" id="emailNova" placeholder="Email">
  <input type="password" id="senhaNova" placeholder="Senha">
  <select id="tipoUsuario">
    <option value="padrao">Padrão</option>
    <option value="admin">Administrador</option>
  </select>
  <button onclick="criarConta()">Criar Conta</button>

  <h3>Pesquisar/Filtrar Usuários</h3>
  <input type="text" id="busca" placeholder="Pesquisar por número ou email" oninput="filtrarUsuarios()">
  <select id="filtroTipo" onchange="filtrarUsuarios()">
    <option value="">Todos</option>
    <option value="padrao">Padrão</option>
    <option value="admin">Administrador</option>
  </select>

  <div id="userList" class="user-list"></div>
</div>

<!-- PÁGINA DE SINAIS -->
<div class="box hidden" id="paginaSinais">
  <h2>Master Bot</h2>
  <button onclick="voltarLogin()">Sair</button>
  <div class="sinais-box">
    <h3>Escolher casas de apostas:</h3>
    <select id="casas" onchange="novaCasa()">
      <option value="Elephantbet">Elephantbet</option>
      <option value="888bet">888bet</option>
      <option value="Placard">Placard</option>
      <option value="Betyetu">Betyetu</option>
      <option value="Jogabets">Jogabets</option>
      <option value="Premierbet">Premierbet</option>
    </select>

    <div id="quadradinhos">
      <div class="quadrado"></div><div class="quadrado"></div><div class="quadrado"></div><div class="quadrado"></div>
      <div class="quadrado"></div><div class="quadrado"></div><div class="quadrado"></div><div class="quadrado"></div>
      <div class="quadrado"></div><div class="quadrado"></div><div class="quadrado"></div><div class="quadrado"></div>
    </div>

    <button onclick="gerarSinal()">Gerar Sinal</button>
    <div id="protecao">Proteção recomendada 2X--5X</div>
  </div>
</div>

<div class="popup" id="popupMsg"></div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDBzFKolbX8bA5iUviRPmA6YYNMGYL8RsI",
  authDomain: "meuprojecto-cfbd3.firebaseapp.com",
  projectId: "meuprojecto-cfbd3",
  storageBucket: "meuprojecto-cfbd3.appspot.com",
  messagingSenderId: "688580446659",
  appId: "1:688580446659:web:0032fd97c6c3f6c5d7d576",
  measurementId: "G-CKJJGC7SB4"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
const SENHA_ADMIN = "stephanie123";

const loginBox = document.getElementById("loginBox");
const painelSenhaBox = document.getElementById("painelSenhaBox");
const painelBox = document.getElementById("painelBox");
const paginaSinais = document.getElementById("paginaSinais");
const popup = document.getElementById("popupMsg");

function mostrarPopup(msg,tipo="sucesso"){
  popup.innerText=msg;
  popup.style.background=tipo==="sucesso"?"#28a745":"#ff4d4f";
  popup.classList.add("show");
  setTimeout(()=>popup.classList.remove("show"),2000);
}

function transicao(sair,entrar){
  sair.classList.add("fade-out");
  setTimeout(()=>{
    sair.classList.add("hidden");
    sair.classList.remove("fade-out");
    entrar.classList.remove("hidden");
  },400);
}

function mostrarPainelSenha(){ transicao(loginBox,painelSenhaBox); }
function entrarPainel(){
  const senha=document.getElementById("adminSenha").value;
  if(senha===SENHA_ADMIN){
    transicao(painelSenhaBox,painelBox);
    carregarUsuarios();
    mostrarPopup("Bem-vindo ao Painel!","sucesso");
  } else {
    mostrarPopup("Senha incorreta!","erro");
  }
}
function sairPainel(){ transicao(painelBox,loginBox); document.getElementById("adminSenha").value=""; }

function fazerLogin(){
  const email=document.getElementById("email").value;
  const senha=document.getElementById("senha").value;
  auth.signInWithEmailAndPassword(email,senha)
    .then(()=> {
      mostrarPopup("Login bem-sucedido!","sucesso");
      transicao(loginBox,paginaSinais);
    })
    .catch(e=>mostrarPopup("Erro: "+e.message,"erro"));
}

function voltarLogin(){ transicao(paginaSinais,loginBox); }

// Dashboard
let usuariosCache = [];
const totalUsers = document.getElementById("totalUsers");

async function criarConta(){
  const numero=document.getElementById("numero").value;
  const email=document.getElementById("emailNova").value;
  const senha=document.getElementById("senhaNova").value;
  const tipo=document.getElementById("tipoUsuario").value;
  if(!numero||!email||!senha){
    mostrarPopup("Preencha todos os campos!","erro");
    return;
  }
  try{
    const cred=await auth.createUserWithEmailAndPassword(email,senha);
    await db.collection("usuarios").doc(cred.user.uid).set({numero,email,tipo,criadoEm:new Date()});
    document.getElementById("numero").value="";
    document.getElementById("emailNova").value="";
    document.getElementById("senhaNova").value="";
    carregarUsuarios();
    mostrarPopup("Conta criada com sucesso!","sucesso");
  }catch(e){mostrarPopup("Erro: "+e.message,"erro");}
}

async function carregarUsuarios(){
  const snap=await db.collection("usuarios").orderBy("criadoEm","desc").get();
  usuariosCache = snap.docs.map(doc=>({id:doc.id,...doc.data()}));
  atualizarLista(usuariosCache);
}

function atualizarLista(lista){
  const container=document.getElementById("userList");
  container.innerHTML="";
  totalUsers.innerText=lista.length;
  lista.forEach(u=>{
    const cor=u.tipo==="admin"?"#ffe6e6":"#f9f9f9";
    container.innerHTML+=`<div class="user-card" style="background:${cor}"><div class="user-info"><i class="fa-solid fa-user"></i><span>${u.numero} - ${u.email} (${u.tipo})</span></div><button onclick="deletarConta('${u.id}')">Excluir</button></div>`;
  });
}

function filtrarUsuarios(){
  const busca=document.getElementById("busca").value.toLowerCase();
  const tipo=document.getElementById("filtroTipo").value;
  const filtrado=usuariosCache.filter(u=>{
    return (u.numero.toLowerCase().includes(busca)||u.email.toLowerCase().includes(busca))
      &&(tipo?u.tipo===tipo:true);
  });
  atualizarLista(filtrado);
}

async function deletarConta(id){
  if(confirm("Deseja realmente deletar esta conta?")){
    await db.collection("usuarios").doc(id).delete();
    carregarUsuarios();
    mostrarPopup("Conta deletada!","sucesso");
  }
}

// Página de sinais
function gerarSinal(){
  const quadrados = document.querySelectorAll("#quadradinhos .quadrado");
  let horaBase = new Date();
  horaBase.setHours(horaBase.getHours()+2); // GMT+2
  let minutos = horaBase.getMinutes();
  quadrados.forEach((q,i)=>{
    minutos += 2+i; // diferença de 2-3 minutos
    let h = horaBase.getHours().toString().padStart(2,'0');
    let m = (minutos%60).toString().padStart(2,'0');
    q.innerText = `${h}:${m}`;
  });
}

// Ao mudar de casa, limpar sinais
function novaCasa(){
  const quadrados = document.querySelectorAll("#quadradinhos .quadrado");
  quadrados.forEach(q=>q.innerText="");
}
</script>

</body>
</html>
